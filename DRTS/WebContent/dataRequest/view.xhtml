<!DOCTYPE html>

<html xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:pf="http://primefaces.org/ui"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" lang="en-us"
	xmlns="http://www.w3.org/1999/xhtml" class="no-js">

	<c:set var="root" value="#{request.requestURL.substring(0, request.requestURL.length() - request.requestURI.length())}#{request.contextPath}/" scope="request" />

    <h:head>
    	
    	<ui:include src="#{root}includes/scripts.xhtml" />

	   	<title>Data Request Tracking System | Federal Student Aid</title>
    
    </h:head>
    
    <h:body class="section-two">
    
    	<ui:include src="#{root}includes/header.xhtml">
    		<ui:param name="active" value="2" />
    	</ui:include>
    	
    	<div id="content-wrapper">
            <div class="grid">
                <div id="breadcrumb" class="col-1-1 mobile-col-1-1">
                    <h:link value="Home" outcome="#{userSession.homePage}" /> Â» Request <h:outputText value="#{dataRequest.displayId}" />
                </div>
                <section class="col-1-1 mobile-col-1-1">
                    <header id="content-header" class="col-1-1 mobile-col-1-1">
                        <span class="content-header-box">
                            <h1>View Request</h1>
                        </span>
                    </header>
                    <div id="main-content" class="col-1-1 mobile-col-1-1">
                        <section class="col-1-1 mobile-col-1-1">
                        
                        	<h:form styleClass="col-1-1 mobile-col-1-1">
                        	
                        		<p>
      								Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla volutpat dui at metus ultrices, at 
      								sollicitudin felis varius. Cras sed orci nisl. Donec semper ornare dignissim. Fusce et neque finibus, 
      								porttitor elit vel, feugiat lectus. Aliquam nunc odio, placerat vitae dapibus finibus, facilisis venenatis 
      								eros. Vestibulum id purus sit amet risus dapibus elementum. In nulla elit, convallis et quam a, viverra 
      								dapibus justo.
      							</p>
                        	
                        		<div class="form-wrapper col-1-1 mobile-col-1-1">
                                    
                                    <div id="drtsTabs">
                                         <ul>
                                            <li><a href="#general">General</a></li>
                                            <li><a href="#requestor">Requestor</a></li>
                                            <li><a href="#receiver">Receiver</a></li>
                                            <h:panelGroup rendered="#{userSession.admin}">
                                            	<li><a href="#assignment">Assignment</a></li>
                                            </h:panelGroup>
                                            <h:panelGroup rendered="#{userSession.sme or userSession.admin}">
	                                            <li><a href="#resolution">Resolution</a></li>
	                                        </h:panelGroup>
	                                      	<h:panelGroup rendered="#{userSession.admin}">
	                                            <li><a href="#validation">Validation</a></li>
                                            </h:panelGroup>
                                            <li><a href="#attachments">Attachments</a></li>
	                                      	<h:panelGroup rendered="#{userSession.admin and dataRequest.canSendEmail}">
	                                            <li><a href="#email">Email</a></li>
                                            </h:panelGroup>
                                            <h:panelGroup rendered="#{userSession.requestor eq false}">
                                           		<li><a href="#comments">Comments</a></li>
                                            </h:panelGroup>
                                        </ul>
                                        <div id="general">
                                        	<h:panelGroup rendered="#{dataRequest.requestIsNewIteration eq false}">
	                                            <h:outputLabel value="ID"/>
	                                            <h:outputText styleClass="form-text" value="#{dataRequest.displayId}" />
                                            </h:panelGroup>

											<h:outputLabel value="Iteration"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.iteration}" />

											<h:outputLabel value="Status"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.status}" />
                                            
                                            <label>Original Request Date</label>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.createdDateTime}">
								      			<f:converter converterId="defaultDateTimeConverter" />
								      		</h:outputText>
								      		
								      		<h:outputLabel value="Type"/>
								      		<h:outputText styleClass="form-text" value="#{dataRequest.type}" rendered="#{dataRequest.statusDrafted eq false}" />
								      		<h:selectOneMenu value="#{dataRequest.type}" rendered="#{dataRequest.statusDrafted eq true}">
									   			<f:selectItems value="#{dataRequest.types}" />
									   		</h:selectOneMenu>
                                            
                                            <h:outputLabel value="Due Date"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.dueDate}" rendered="#{dataRequest.statusDrafted eq false}">
								      			<f:converter converterId="defaultDateConverter" />
								      		</h:outputText>
								      		<h:inputText styleClass="datepicker" value="#{dataRequest.dueDate}" rendered="#{dataRequest.statusDrafted eq true}">
                                            	<f:converter converterId="defaultDateConverter" />
                                            </h:inputText>
                                            
                                            <h:outputLabel value="Urgency Flag"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.urgent}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:selectBooleanCheckbox value="#{dataRequest.urgent}" rendered="#{dataRequest.statusDrafted eq true}" />
                                            
                                            <h:outputLabel value="PII Flag"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.pii}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:selectBooleanCheckbox value="#{dataRequest.pii}" rendered="#{dataRequest.statusDrafted eq true}" />
                                            
                                            <h:outputLabel value="Related Requests"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.relatedRequests}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputTextarea value="#{dataRequest.relatedRequests}" rendered="#{dataRequest.statusDrafted eq true}" />

											<h:outputLabel value="Topic/Keywords"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.topicKeywords}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputTextarea value="#{dataRequest.topicKeywords}" rendered="#{dataRequest.statusDrafted eq true}" />

											<h:outputLabel value="Description"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.description}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputTextarea value="#{dataRequest.description}" rendered="#{dataRequest.statusDrafted eq true}" />

                                            <h:outputLabel value="Purpose"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.purpose}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputTextarea value="#{dataRequest.purpose}" rendered="#{dataRequest.statusDrafted eq true}" />

                                            <h:outputLabel value="Special Considerations/Issues"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.specialConsiderationsIssues}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputTextarea value="#{dataRequest.specialConsiderationsIssues}" rendered="#{dataRequest.statusDrafted eq true}" />
                                        </div>
                                        <div id="requestor">
                                            <h:outputLabel value="Requestor"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.requestorName}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputText value="#{dataRequest.requestorName}" rendered="#{dataRequest.statusDrafted eq true}" />
                                            
                                        	<h:outputLabel value="Requestor Organization"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.requestorOrganization}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputText value="#{dataRequest.requestorOrganization}" rendered="#{dataRequest.statusDrafted eq true}" />
                                            
                                        	<h:outputLabel value="Requestor Phone"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.requestorPhone}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputText value="#{dataRequest.requestorPhone}" rendered="#{dataRequest.statusDrafted eq true}" />
                                            
                                        	<h:outputLabel value="Requestor Email"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.requestorEmail}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputText value="#{dataRequest.requestorEmail}" rendered="#{dataRequest.statusDrafted eq true}" />
                                        </div>
                                        <div id="receiver">
                                            <h:outputLabel value="Receiver"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.receiverName}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputText value="#{dataRequest.receiverName}" rendered="#{dataRequest.statusDrafted eq true}" />
                                            
                                        	<h:outputLabel value="Receiver Email"/>
                                            <h:outputText styleClass="form-text" value="#{dataRequest.receiverEmail}" rendered="#{dataRequest.statusDrafted eq false}" />
                                            <h:inputText value="#{dataRequest.receiverEmail}" rendered="#{dataRequest.statusDrafted eq true}" />
                                        </div>
                                        <h:panelGroup rendered="#{userSession.admin}">
	                                        <div id="assignment">
	                                        	<h:outputLabel value="Assigned To"/>
	                                        	<h:outputText styleClass="form-text" value="#{dataRequest.assignedSme}" />
		                                  	</div>
	                                  	</h:panelGroup>
	                                  	<h:panelGroup rendered="#{userSession.sme or userSession.admin}">
	                                        <div id="resolution">
	                                            <h:outputLabel value="Resolution"/>
	                                            <h:outputText styleClass="form-text" value="#{dataRequest.resolution}" />
	                                        </div>
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{userSession.admin}">
	                                        <div id="validation">
	                                        	<h:outputLabel value="Assign To"/>
	                                            <h:outputText styleClass="form-text" value="#{dataRequest.assignedValidator}" />
	                                        </div>
                                        </h:panelGroup>
                                        <div id="attachments">
                                        	<label>Attached Files</label>
                                        	<ui:repeat var="file" value="#{dataRequest.attachments}" varStatus="status">
                                        		<span class="form-text">
                                        			#{file.name}
                                        			<a href="/drts/file?file_id=#{file.id}">View</a>
                                        		</span>
                                        	</ui:repeat>
                                        </div>
                                        <h:panelGroup rendered="#{userSession.admin and dataRequest.canSendEmail}">
                                        	<div id="email">
                                        	
                                        		<h:panelGroup rendered="#{dataRequest.pii}">
	                                        		<p>
	                                        		PII warning here.
	                                        		</p>
                                        		</h:panelGroup>
                                        	
				      							<h:outputLabel value="To"/>
				      							<h:inputText value="#{emailBean.to}" />
				      							
				      							<h:outputLabel value="Subject"/>
				      							<h:inputText value="#{emailBean.subject}" />
				      							
				      							<h:outputLabel value="Message"/>
				      							<h:inputTextarea value="#{emailBean.messageContent}" />
				      						</div>
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{userSession.requestor eq false}">
	                                        <div id="comments">
										   		<h:outputLabel value="Add Comments"/>
	                                            <h:inputTextarea value="#{dataRequest.newComments}" />
	                                            
	                                            <h:outputLabel value="Comments"/>
	                                            <h:outputText value="#{dataRequest.comments}" escape="false" />
	                                        </div>
                                        </h:panelGroup>
                                    </div>
                        	
                        		</div>
                        		
                        		<h:panelGroup rendered="#{dataRequest.statusDrafted and (dataRequest.requestIsNewIteration eq false)}">
	                        		<div class="form-control col-1-1 mobile-col-1-1">
	                                	<h:commandButton value="Save" styleClass="button" action="#{dataRequest.updateRequest(99)}" />
	                                	<h:commandButton value="Submit" styleClass="button" action="#{dataRequest.updateRequest(3)}" />
	                                </div>
                                </h:panelGroup>
                                
                                <h:panelGroup rendered="#{dataRequest.requestIsNewIteration}">
	                        		<div class="form-control col-1-1 mobile-col-1-1">
	                                	<h:commandButton value="Save as Draft" styleClass="button" action="#{dataRequest.updateRequest(1)}" />
                                		<h:commandButton value="Create" styleClass="button" action="#{dataRequest.updateRequest(2)}" />
	                                </div>
                                </h:panelGroup>
                                
                                <h:panelGroup rendered="#{userSession.admin and dataRequest.canSendEmail}">
	                        		<div class="form-control col-1-1 mobile-col-1-1">
	                                	<h:commandButton value="Send Email" styleClass="button" action="#{emailBean.sendEmail(dataRequest.attachments)}" />
	                                </div>
                                </h:panelGroup>
    	
    						</h:form>
    						
    						<h:panelGroup rendered="#{dataRequest.statusDrafted or dataRequest.requestIsNewIteration}">
	    						<div id="current_request_id_div" hidden="true"><h:outputText value="#{dataRequest.id}" /></div>
						    	<div id="fileuploader">Upload</div>
					    	</h:panelGroup>
					    	
                        </section>
                    </div>
                </section>
            </div>
        </div>
        
        <ui:include src="#{root}includes/footer.xhtml" />
    	
    </h:body>
    
</html>